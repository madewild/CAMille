<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>CAMILLE</title>
  <meta name="description" content="Centre d'archives sur les médias et l'information">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="icon" href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon">
  <link rel="stylesheet" href="{{ url_for('static', filename='results.css') }}">
  <script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>
</head>
<body>
    <div class="serp">
        <div class="serp__layout">
            <div class="serp__header">
                <div class="serp__search">
                    <form class="serp__form" action="/" method="GET">
                    <div>
                        <input name="query" type="search" value="{{query}}"
                            class="serp__query" 
                            maxlength="512"
                            autocomplete="off"
                            title="Search"
                            aria-label="Search"
                            dir="ltr"
                            spellcheck="true"
                            autofocus="autofocus"
                        >
                    </div>
                    <button class="serp__button" aria-label="Search" type="submit">
                        <div class="serp__ico"></div>
                    </button>
                    </form>
                    {% if (fuzzy == "false") and (complex == "false") %}
                    <form class="custom_form" action="/" method="GET">
                        <p class="serp__query">Inclure les termes proches ?
                        <input type="hidden" id="query" name="query" value="{{query}}">
                        <input type="hidden" id="fuzzy" name="fuzzy" value="true">
                        <input type="submit" value="OK"></p>
                    </form>
                    {% endif %}
                    <form class="custom_form" action="/" method="GET">
                        <p class="serp__query">Restreindre à un journal :
                        <select id="journal" name="journal">
                            {% for paper in papers %}
                            <option value="{{paper['code']}}">{{paper['name']}}</option>
                            {% endfor %}
                        </select>
                        <input type="hidden" id="query" name="query" value="{{query}}">
                        <input type="submit" value="OK"></p>
                    </form>
                </div>
                <a class="serp__logo" href="/"></a>
            </div>
        </div>
        <div class="serp__body">
            <div class="serp__main serp__results">
                <span class="stats">{{stats}}</span>
                <div class="serp__web">
                    {% for result in results %}
                    <div class="serp__result">
                        <a href="{{url}}&p={{p}}&doc={{result['id']}}">
                            <div class="serp__title">{{result['display']}}</div>
                        </a>
                        <span class="serp__description">{{result['matches']|safe}}</span>
                    </div>
                    {% endfor %}
                </div>
                {% if maxp > 1 %}
                <div class="serp__pagination">
                    <ul style="counter-reset: pagination {{firstp-2}};">
                        {% if p == 1 %}
                        <li><a class="serp__disabled"></a></li>
                        {% else %}
                        <li><a href="{{url}}&p={{p-1}}"></a></li>
                        {% endif %}
                        {% for i in range(firstp, lastp) %}
                        {% if i == p %}
                        <li class="serp__pagination-active">
                        {% else %}
                        <li>
                        {% endif %}
                        <a href="{{url}}&p={{i}}"></a></li>
                        {% endfor %}
                        {% if p == maxp %}
                        <li><a class="serp__disabled"></a></li>
                        {% else %}
                        <li><a href="{{url}}&p={{p+1}}"></a></li>
                        {% endif %}
                    </ul>
                </div>
                {% endif %}
            </div>
            {% if (doc != "false") %}
            <div class="pdf">
                <canvas id="the-canvas"></canvas>
                <script src="{{ url_for('static', filename='pdfjs.js') }}"></script>
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>